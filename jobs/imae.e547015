wandb: Currently logged in as: vickie02736. Use `wandb login --relogin` to force relogin
wandb: Currently logged in as: vickie02736. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.16.6
wandb: Run data is saved locally in /lustre/home/uceckz0/Project/imae/jobs/wandb/run-20240429_073029-qgqdh3bs
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run worthy-planet-2
wandb: ‚≠êÔ∏è View project at https://wandb.ai/vickie02736/imae
wandb: üöÄ View run at https://wandb.ai/vickie02736/imae/runs/qgqdh3bs
wandb: Tracking run with wandb version 0.16.6
wandb: Run data is saved locally in /lustre/home/uceckz0/Project/imae/jobs/wandb/run-20240429_073029-5ficlp9f
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run misunderstood-morning-1
wandb: ‚≠êÔ∏è View project at https://wandb.ai/vickie02736/imae
wandb: üöÄ View run at https://wandb.ai/vickie02736/imae/runs/5ficlp9f
Traceback (most recent call last):
  File "/lustre/home/uceckz0/Project/imae/jobs/../program/main.py", line 258, in <module>
    main(args)
  File "/lustre/home/uceckz0/Project/imae/jobs/../program/main.py", line 110, in main
    model = DDP(model, device_ids=device_id) # find_unused_parameters=True
  File "/home/uceckz0/miniconda3/envs/imae/lib/python3.9/site-packages/torch/nn/parallel/distributed.py", line 798, in __init__
    _verify_param_shape_across_processes(self.process_group, parameters)
  File "/home/uceckz0/miniconda3/envs/imae/lib/python3.9/site-packages/torch/distributed/utils.py", line 263, in _verify_param_shape_across_processes
    return dist._verify_params_across_processes(process_group, tensors, logger)
torch.distributed.DistBackendError: NCCL error in: ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:1691, invalid usage (run with NCCL_DEBUG=WARN for details), NCCL version 2.19.3
ncclInvalidUsage: This usually reflects invalid usage of NCCL library.
Last error:
Duplicate GPU detected : rank 0 and rank 1 both on CUDA device 58000
Traceback (most recent call last):
  File "/lustre/home/uceckz0/Project/imae/jobs/../program/main.py", line 258, in <module>
    main(args)
  File "/lustre/home/uceckz0/Project/imae/jobs/../program/main.py", line 110, in main
    model = DDP(model, device_ids=device_id) # find_unused_parameters=True
  File "/home/uceckz0/miniconda3/envs/imae/lib/python3.9/site-packages/torch/nn/parallel/distributed.py", line 798, in __init__
    _verify_param_shape_across_processes(self.process_group, parameters)
  File "/home/uceckz0/miniconda3/envs/imae/lib/python3.9/site-packages/torch/distributed/utils.py", line 263, in _verify_param_shape_across_processes
    return dist._verify_params_across_processes(process_group, tensors, logger)
torch.distributed.DistBackendError: NCCL error in: ../torch/csrc/distributed/c10d/ProcessGroupNCCL.cpp:1691, invalid usage (run with NCCL_DEBUG=WARN for details), NCCL version 2.19.3
ncclInvalidUsage: This usually reflects invalid usage of NCCL library.
Last error:
Duplicate GPU detected : rank 1 and rank 0 both on CUDA device 58000
wandb: - 0.005 MB of 0.005 MB uploadedwandb: - 0.005 MB of 0.005 MB uploadedwandb: ERROR Error while calling W&B API: An internal error occurred. Please contact support. (<Response [500]>)
wandb: \ 0.005 MB of 0.005 MB uploadedwandb: \ 0.005 MB of 0.005 MB uploadedwandb: | 0.005 MB of 0.005 MB uploadedwandb: | 0.005 MB of 0.005 MB uploadedwandb: / 0.008 MB of 0.008 MB uploadedwandb: / 0.005 MB of 0.005 MB uploadedwandb: - 0.009 MB of 0.014 MB uploadedwandb: üöÄ View run misunderstood-morning-1 at: https://wandb.ai/vickie02736/imae/runs/5ficlp9f
wandb: ‚≠êÔ∏è View project at: https://wandb.ai/vickie02736/imae
wandb: Synced 6 W&B file(s), 0 media file(s), 2 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240429_073029-5ficlp9f/logs
wandb: - 0.008 MB of 0.008 MB uploadedwandb: \ 0.008 MB of 0.014 MB uploadedwandb: üöÄ View run worthy-planet-2 at: https://wandb.ai/vickie02736/imae/runs/qgqdh3bs
wandb: ‚≠êÔ∏è View project at: https://wandb.ai/vickie02736/imae
wandb: Synced 6 W&B file(s), 0 media file(s), 2 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240429_073029-qgqdh3bs/logs
Exception in thread NetStatThr:
Traceback (most recent call last):
  File "/home/uceckz0/miniconda3/envs/imae/lib/python3.9/threading.py", line 980, in _bootstrap_inner
Exception in thread IntMsgThr:
Traceback (most recent call last):
  File "/home/uceckz0/miniconda3/envs/imae/lib/python3.9/threading.py", line 980, in _bootstrap_inner
    self.run()
  File "/home/uceckz0/miniconda3/envs/imae/lib/python3.9/threading.py", line 917, in run
    self._target(*self._args, **self._kwargs)
  File "/home/uceckz0/miniconda3/envs/imae/lib/python3.9/site-packages/wandb/sdk/wandb_run.py", line 300, in check_internal_messages
    self.run()
  File "/home/uceckz0/miniconda3/envs/imae/lib/python3.9/threading.py", line 917, in run
    self._target(*self._args, **self._kwargs)
  File "/home/uceckz0/miniconda3/envs/imae/lib/python3.9/site-packages/wandb/sdk/wandb_run.py", line 268, in check_network_status
    self._loop_check_status(
  File "/home/uceckz0/miniconda3/envs/imae/lib/python3.9/site-packages/wandb/sdk/wandb_run.py", line 224, in _loop_check_status
    local_handle = request()
  File "/home/uceckz0/miniconda3/envs/imae/lib/python3.9/site-packages/wandb/sdk/interface/interface.py", line 848, in deliver_network_status
    self._loop_check_status(
  File "/home/uceckz0/miniconda3/envs/imae/lib/python3.9/site-packages/wandb/sdk/wandb_run.py", line 224, in _loop_check_status
    return self._deliver_network_status(status)
  File "/home/uceckz0/miniconda3/envs/imae/lib/python3.9/site-packages/wandb/sdk/interface/interface_shared.py", line 510, in _deliver_network_status
    local_handle = request()
  File "/home/uceckz0/miniconda3/envs/imae/lib/python3.9/site-packages/wandb/sdk/interface/interface.py", line 856, in deliver_internal_messages
    return self._deliver_internal_messages(internal_message)
  File "/home/uceckz0/miniconda3/envs/imae/lib/python3.9/site-packages/wandb/sdk/interface/interface_shared.py", line 516, in _deliver_internal_messages
    return self._deliver_record(record)
  File "/home/uceckz0/miniconda3/envs/imae/lib/python3.9/site-packages/wandb/sdk/interface/interface_shared.py", line 459, in _deliver_record
    return self._deliver_record(record)
  File "/home/uceckz0/miniconda3/envs/imae/lib/python3.9/site-packages/wandb/sdk/interface/interface_shared.py", line 459, in _deliver_record
    handle = mailbox._deliver_record(record, interface=self)
  File "/home/uceckz0/miniconda3/envs/imae/lib/python3.9/site-packages/wandb/sdk/lib/mailbox.py", line 455, in _deliver_record
    handle = mailbox._deliver_record(record, interface=self)
  File "/home/uceckz0/miniconda3/envs/imae/lib/python3.9/site-packages/wandb/sdk/lib/mailbox.py", line 455, in _deliver_record
    interface._publish(record)
  File "/home/uceckz0/miniconda3/envs/imae/lib/python3.9/site-packages/wandb/sdk/interface/interface_sock.py", line 51, in _publish
    interface._publish(record)
  File "/home/uceckz0/miniconda3/envs/imae/lib/python3.9/site-packages/wandb/sdk/interface/interface_sock.py", line 51, in _publish
    self._sock_client.send_record_publish(record)
  File "/home/uceckz0/miniconda3/envs/imae/lib/python3.9/site-packages/wandb/sdk/lib/sock_client.py", line 221, in send_record_publish
    self._sock_client.send_record_publish(record)
  File "/home/uceckz0/miniconda3/envs/imae/lib/python3.9/site-packages/wandb/sdk/lib/sock_client.py", line 221, in send_record_publish
    self.send_server_request(server_req)
  File "/home/uceckz0/miniconda3/envs/imae/lib/python3.9/site-packages/wandb/sdk/lib/sock_client.py", line 155, in send_server_request
    self.send_server_request(server_req)
  File "/home/uceckz0/miniconda3/envs/imae/lib/python3.9/site-packages/wandb/sdk/lib/sock_client.py", line 155, in send_server_request
    self._send_message(msg)
  File "/home/uceckz0/miniconda3/envs/imae/lib/python3.9/site-packages/wandb/sdk/lib/sock_client.py", line 152, in _send_message
    self._send_message(msg)
  File "/home/uceckz0/miniconda3/envs/imae/lib/python3.9/site-packages/wandb/sdk/lib/sock_client.py", line 152, in _send_message
    self._sendall_with_error_handle(header + data)
  File "/home/uceckz0/miniconda3/envs/imae/lib/python3.9/site-packages/wandb/sdk/lib/sock_client.py", line 130, in _sendall_with_error_handle
    self._sendall_with_error_handle(header + data)
  File "/home/uceckz0/miniconda3/envs/imae/lib/python3.9/site-packages/wandb/sdk/lib/sock_client.py", line 130, in _sendall_with_error_handle
    sent = self._sock.send(data)
BrokenPipeError: [Errno 32] Broken pipe
    sent = self._sock.send(data)
BrokenPipeError: [Errno 32] Broken pipe
[2024-04-29 07:30:59,687] torch.distributed.elastic.multiprocessing.api: [ERROR] failed (exitcode: 1) local_rank: 0 (pid: 176390) of binary: /home/uceckz0/miniconda3/envs/imae/bin/python
Traceback (most recent call last):
  File "/home/uceckz0/miniconda3/envs/imae/bin/torchrun", line 8, in <module>
    sys.exit(main())
  File "/home/uceckz0/miniconda3/envs/imae/lib/python3.9/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 347, in wrapper
    return f(*args, **kwargs)
  File "/home/uceckz0/miniconda3/envs/imae/lib/python3.9/site-packages/torch/distributed/run.py", line 812, in main
    run(args)
  File "/home/uceckz0/miniconda3/envs/imae/lib/python3.9/site-packages/torch/distributed/run.py", line 803, in run
    elastic_launch(
  File "/home/uceckz0/miniconda3/envs/imae/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 135, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
  File "/home/uceckz0/miniconda3/envs/imae/lib/python3.9/site-packages/torch/distributed/launcher/api.py", line 268, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
../program/main.py FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2024-04-29_07:30:59
  host      : node-e00a-012.myriad.ucl.ac.uk
  rank      : 1 (local_rank: 1)
  exitcode  : 1 (pid: 176391)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2024-04-29_07:30:59
  host      : node-e00a-012.myriad.ucl.ac.uk
  rank      : 0 (local_rank: 0)
  exitcode  : 1 (pid: 176390)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
